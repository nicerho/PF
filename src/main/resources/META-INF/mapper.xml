<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="pfDB">
	<insert id="adminInsert">
		insert into admin
		values('0',#{abranch},#{adep},#{apos},#{aid},#{aname},#{apw},#{aemail},#{atel},'Y',now());
	</insert>
	<select id="login" resultType="ad" parameterType="string">
		select * from
		admin where aid=#{insertId}
	</select>
	<select id="findAdminByDep" resultType="ad"
		parameterType="string">
		select * from admin where adep=#{adep} order by ano
		desc;
	</select>
	<select id="selectAll" resultType="ad">
		select * from admin order by
		ano desc;
	</select>
	<select id="selectByName" resultType="ad" parameterType="string">
		select *
		from admin where aname=#{aname} order by ano desc;
	</select>
	<select id="selectByname" resultType="ad" parameterType="string">
		select *
		from admin where aname like CONCAT('%',#{keyword},'%') order by ano
		desc;
	</select>
	<select id="selectByTel" resultType="ad" parameterType="string">
		select *
		from admin where atel like CONCAT('%',#{keyword},'%') order by ano
		desc;
	</select>
	<select id="selectById" resultType="ad" parameterType="string">
		select *
		from admin where aid like CONCAT('%',#{keyword},'%') order by ano
		desc;
	</select>
	<update id="changeAdminConfigToY" parameterType="string">
		update admin set
		ause='Y' where ano=#{parameter}
	</update>
	<update id="changeAdminConfigToN" parameterType="string">
		update admin set
		ause='N' where ano=#{parameter}
	</update>
	<insert id="noticeInsert">
		insert into notice
		values('0',#{ctitle},#{cwriter},#{csection},0,#{cfiledir},#{cfilename},now());
	</insert>
	<select id="selectNoticeByPage" parameterType="map"
		resultType="nt">
		SELECT * FROM notice
		<where>
			<if test="search != null and search != ''">
				AND ctitle LIKE CONCAT('%', #{search}, '%')
			</if>
		</where>
		ORDER BY cno DESC
		LIMIT #{start}, #{pageSize}
	</select>
	<select id="countNotices" parameterType="map" resultType="int">
		SELECT COUNT(*) FROM notice
		<where>
			<if test="search != null and search != ''">
				AND ctitle LIKE CONCAT('%', #{search}, '%')
			</if>
		</where>
	</select>
	<delete id="deleteNotice">
		delete from notice where cno=#{parameter}
	</delete>
	<select id="selectNoticeByCno" parameterType="string"
		resultType="nt">
		select * from notice where cno=#{parameter}
	</select>
	<update id="chnageClicked" parameterType="string">
		update notice set
		cclicked=cclicked+1 where cno=#{parameter}
	</update>
	<select id="selectFaqByfno" parameterType="string"
		resultType="fd">
		select * from notice where fno=#{parameter}
	</select>
	<select id="countFaq" parameterType="map" resultType="int">
		SELECT COUNT(*) FROM faq
		<where>
			<if test="search != null and search != ''">
				AND fquestion LIKE CONCAT('%', #{search}, '%')
			</if>
		</where>
	</select>
	<select id="selectFaqByPage" parameterType="map" resultType="fd">
		SELECT * FROM faq
		<where>
			<if test="search != null and search != ''">
				AND fquestion LIKE CONCAT('%', #{search}, '%')
			</if>
		</where>
		ORDER BY fno DESC
		LIMIT #{start}, #{pageSize}
	</select>
	<delete id="deleteFaq">
		delete from faq where fno=#{parameter}
	</delete>
	<select id="countAdmin" parameterType="map" resultType="int">
		SELECT COUNT(*) FROM admin
		<where>
			<if test="search != null and search != '' and searchpart=='이름'">
				AND aname LIKE CONCAT('%', #{search}, '%')
			</if>
			<if test="search != null and search != '' and searchpart=='연락처'">
				AND atel LIKE CONCAT('%', #{search}, '%')
			</if>
			<if test="search != null and search != '' and searchpart=='아이디'">
				AND aid LIKE CONCAT('%', #{search}, '%')
			</if>
		</where>
		<where>
			<if test="adep != null and adep != ''">
				 adep=#{adep}
			</if>
		</where>
	</select>
	<select id="selectAdminByPage" parameterType="map"
		resultType="ad">
		SELECT * FROM admin
		<where>
			<if test="search != null and search != '' and searchpart=='이름'">
				AND aname LIKE CONCAT('%', #{search}, '%')
			</if>
			<if test="search != null and search != '' and searchpart=='연락처'">
				AND atel LIKE CONCAT('%', #{search}, '%')
			</if>
			<if test="search != null and search != '' and searchpart=='아이디'">
				AND aid LIKE CONCAT('%', #{search}, '%')
			</if>
		</where>
		<where>
			<if test="adep != null and adep != ''">
				 adep=#{adep}
			</if>
		</where>
		ORDER BY ano DESC
		LIMIT #{start}, #{pageSize}
	</select>
</mapper>